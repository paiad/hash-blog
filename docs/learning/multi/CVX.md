---
title: üëëCVX
createTime: 2025/03/27 10:23:50
permalink: /article/fuq0saok/
tags:
  - Matlab
  - CVX
---

### CVXÂ∑•ÂÖ∑ÂåÖ

<CardGrid>
    <LinkCard icon="skill-icons:matlab-light" title="CVXÂ∑•ÂÖ∑ÂåÖ" href="https://cvxr.com/cvx/download/"/>
</CardGrid>

```bash
>> cvx_begin
>> variable x(2)
>> minimize(norm(x,1))
>> subject to
>>  x >= 0
>> cvx_end
```

### ÂéüÂßã‰ª£Á†Å
```matlab
clc
clear all
close all

N = 100;
x0 = linspace(0, 400, N)';
y0 = zeros(N, 1);
H = 100 * ones(N, 1);
x_o = 0; y_o = 0; x_f = 400; y_f = 0;
x_b = 200; y_b = 200; 
x_e = 20; y_e = 250;
x_e2 = 300; y_e2 = 50;
x_e3 = 50; y_e3 = 100;
v = 20;

for mm = 1:5
    p = 0.1 * ones(N, 1);  % ‰º†ËæìÂäüÁéá20dbm
    p_e = 0.1 * ones(N, 1);  % 18dbm
    gammar = 10^(11.4) * p;
    gammar_e = 10^(11.4) * p;
    
    % Ê≥®ÊÑèÔºö‰ª•‰∏ãË∑ØÂæÑÈúÄË¶ÅÊ†πÊçÆ‰Ω†ÁöÑÂÆûÈôÖCVXÂÆâË£ÖË∑ØÂæÑË∞ÉÊï¥
    % cd C:\xxx\yyy\CVX\cvx
    % cvx_setup
    
    n = 6 * N + 1;
    cvx_begin
        variable x(n) nonnegative
        maximize(x(6*N+1))
        subject to
        for k = 1:N
            RDL = log2(1 + gammar(k) ./ ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2));
            REL = log2(1 + gammar_e(k) ./ ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2));
            REL2 = log2(1 + gammar_e(k) ./ ((x0(k)-x_e2)^2 + (y0(k)-x_e2)^2 + H(k)^2));
            REL3 = log2(1 + gammar_e(k) ./ ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2));
            
            ADL = gammar(k) ./ (log(2) * ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2 + gammar(k)) .* ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2));
            AEL = gammar_e(k) ./ (log(2) * ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2));
            AEL2 = gammar_e(k) ./ (log(2) * ((x0(k)-x_e2)^2 + (y0(k)-x_e2)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e2)^2 + (y0(k)-y_e2)^2 + H(k)^2));
            AEL3 = gammar_e(k) ./ (log(2) * ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2));
            
            BDL = -2 * (x_b - x0(k)) .* ADL;
            BEL = -2 * (x_e - x0(k)) .* AEL;
            BEL2 = -2 * (x_e2 - x0(k)) .* AEL2;
            BEL3 = -2 * (x_e3 - x0(k)) .* AEL3;
            CDL = -2 * (y_b - y0(k)) .* ADL;
            CEL = -2 * (y_e - y0(k)) .* AEL;
            CEL2 = -2 * (y_e2 - y0(k)) .* AEL2;
            CEL3 = -2 * (y_e3 - y0(k)) .* AEL3;
            
            x(2*N+k) <= RDL - ADL .* (square(x(k)) + square(x(N+k))) - BDL .* x(k) - CDL .* x(N+k);
            x(3*N+k) <= REL - AEL .* (square(x(k)) + square(x(N+k))) - BEL .* x(k) - CEL .* x(N+k);
            x(4*N+k) <= REL2 - AEL2 .* (square(x(k)) + square(x(N+k))) - BEL2 .* x(k) - CEL2 .* x(N+k);
            x(5*N+k) <= REL3 - AEL3 .* (square(x(k)) + square(x(N+k))) - BEL3 .* x(k) - CEL3 .* x(N+k);
        end   
        
        i = (2*N+1):(3*N);
        j = (3*N+1):(4*N);
        A = x(j) - x(i);
        A1 = x(j+N) - x(i);
        A2 = x(j+2*N) - x(i);
        
        for kk = 1:N
            dd = (x0(kk)-x_b)^2 + (y0(kk)-y_b)^2 + H(kk)^2;
            de1 = (x0(kk)-x_e)^2 + (y0(kk)-y_e)^2 + H(kk)^2;
            de2 = (x0(kk)-x_e2)^2 + (y0(kk)-y_e2)^2 + H(kk)^2;
            de3 = (x0(kk)-x_e3)^2 + (y0(kk)-x_e3)^2 + H(kk)^2;
            if (dd >= de1)
                A(kk) = 0;
            end
            if (dd >= de2)
                A1(kk) = 0;
            end
            if (dd >= de3)
                A2(kk) = 0;
            end
        end
        
        sum(A) <= -x(6*N+1);
        sum(A1) <= -x(6*N+1);
        sum(A2) <= -x(6*N+1);
        
        for jj = 1:N-1
            square(x0(jj+1) + x(jj+1) - x0(jj) - x(jj)) + square(y0(jj+1) + x(N+jj+1) - y0(jj) - x(N+jj)) <= v^2;
        end
        square(x0(1) + x(1) - x_o) + square(y0(1) + x(N+1) - y_o) <= v^2;
        square(x_f - x(N) - x0(N)) + square(y_f - x(N+N) - y0(N)) <= v^2;
    cvx_end
    
    x0 = x0 + x(1:N);
    y0 = y0 + x(N+1:2*N);
    
    % ËÆ°ÁÆó‰øùÂØÜÈÄüÁéá
    rate = []; rate_u = []; rate_e0 = [];
    for l = 1:size(x0,1)   
        rate_u = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_b-x0(l))^2 + (y_b-y0(l))^2));
        rate_e = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e-x0(l))^2 + (y_e-y0(l))^2));
        rate_e2 = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e2-x0(l))^2 + (y_e2-y0(l))^2));
        rate_e3 = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e3-x0(l))^2 + (y_e3-y0(l))^2));
        rate_e0 = max([rate_e, rate_e2, rate_e3]);
        rate(l) = max(rate_u - rate_e0, 0);
    end
    secrecy_rate(mm) = sum(rate);
end

x0 = [0; x0; 400];
y0 = [0; y0; 0];
z0 = [0; H; 0];  % Ê∑ªÂä†È´òÂ∫¶Áª¥Â∫¶ÔºåËµ∑ÁÇπÂíåÁªàÁÇπÂú®Âú∞Èù¢ (z=0)ÔºåË∑ØÂæÑÂú® H=100

for i = 1:size(x0)-1
    speed(i) = sqrt((x0(i+1)-x0(i))^2 + (y0(i+1)-y0(i))^2);
end 

% 2D ÁªòÂõæÈÉ®ÂàÜÔºà‰øùÁïôÂéüÊúâÂπ≥Èù¢ÂõæÔºâ
figure;
plot(x0, y0, 'b-', 'LineWidth', 1.5); % Êó†‰∫∫Êú∫Ë∑ØÂæÑ
hold on;

% Ê†áÊ≥®Áî®Êà∑‰ΩçÁΩÆ
plot(x_b, y_b, 'ro', 'MarkerSize', 10, 'LineWidth', 2);
text(x_b+5, y_b+5, 'User', 'FontSize', 12);

% Ê†áÊ≥®‰∏â‰∏™Á™ÉÂê¨ËÄÖ‰ΩçÁΩÆ
plot(x_e, y_e, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e+5, y_e+5, 'Eavesdropper 1', 'FontSize', 12);

plot(x_e2, y_e2, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e2+5, y_e2+5, 'Eavesdropper 2', 'FontSize', 12);

plot(x_e3, y_e3, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e3+5, y_e3+5, 'Eavesdropper 3', 'FontSize', 12);

% Ê†áÊ≥®Ëµ∑ÁÇπÂíåÁªàÁÇπ
plot(x0(1), y0(1), 'g^', 'MarkerSize', 12, 'LineWidth', 2);
text(x0(1)+5, y0(1)+5, 'Start', 'FontSize', 12);

plot(x0(end), y0(end), 'ms', 'MarkerSize', 12, 'LineWidth', 2);
text(x0(end)+5, y0(end)+5, 'End', 'FontSize', 12);

grid on;
xlabel('X coordinate');
ylabel('Y coordinate');
title('UAV Trajectory with User and Eavesdroppers (2D)');
legend('UAV Path', 'User', 'Eavesdropper 1', 'Eavesdropper 2', 'Eavesdropper 3', 'Start', 'End');
hold off;

% 3D ÁªòÂõæÈÉ®ÂàÜ
figure;
plot3(x0, y0, z0, 'b-', 'LineWidth', 1.5); % Êó†‰∫∫Êú∫Ë∑ØÂæÑ
hold on;

% Ê†áÊ≥®Áî®Êà∑‰ΩçÁΩÆ (Âú∞Èù¢ z=0)
plot3(x_b, y_b, 0, 'ro', 'MarkerSize', 10, 'LineWidth', 2);
text(x_b+5, y_b+5, 0, 'User', 'FontSize', 12);

% Ê†áÊ≥®‰∏â‰∏™Á™ÉÂê¨ËÄÖ‰ΩçÁΩÆ (Âú∞Èù¢ z=0)
plot3(x_e, y_e, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e+5, y_e+5, 0, 'Eavesdropper 1', 'FontSize', 12);

plot3(x_e2, y_e2, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e2+5, y_e2+5, 0, 'Eavesdropper 2', 'FontSize', 12);

plot3(x_e3, y_e3, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2);
text(x_e3+5, y_e3+5, 0, 'Eavesdropper 3', 'FontSize', 12);

% Ê†áÊ≥®Ëµ∑ÁÇπÂíåÁªàÁÇπ (Âú∞Èù¢ z=0)
plot3(x0(1), y0(1), z0(1), 'g^', 'MarkerSize', 12, 'LineWidth', 2);
text(x0(1)+5, y0(1)+5, z0(1), 'Start', 'FontSize', 12);

plot3(x0(end), y0(end), z0(end), 'ms', 'MarkerSize', 12, 'LineWidth', 2);
text(x0(end)+5, y0(end)+5, z0(end), 'End', 'FontSize', 12);

grid on;
xlabel('X coordinate');
ylabel('Y coordinate');
zlabel('Z coordinate (Height)');
title('UAV Trajectory with User and Eavesdroppers (3D)');
legend('UAV Path', 'User', 'Eavesdropper 1', 'Eavesdropper 2', 'Eavesdropper 3', 'Start', 'End');
view(-37.5, 30); % ËÆæÁΩÆËßÜËßíÔºå‰æø‰∫éËßÇÂØü
hold off;

% ÁªòÂà∂‰øùÂØÜÈÄüÁéáÈöèËø≠‰ª£Ê¨°Êï∞ÁöÑÂèòÂåñ
figure;
plot(1:5, secrecy_rate, 'b-o', 'LineWidth', 1.5, 'MarkerSize', 8);
grid on;
xlabel('Iteration Number');
ylabel('Secrecy Rate (bits/s)');
title('Secrecy Rate vs. Iteration Number');
legend('Secrecy Rate');
disp('Secrecy Rate for each iteration:');
disp(secrecy_rate);
```

### ‰ª£Á†Å‰∏≠ÁöÑÂÖ≥ÈîÆÂÖ¨Âºè‰∏éÊÑè‰πâ
1. ÂàùÂßãÂåñ‰∏éÁ≥ªÁªüÂèÇÊï∞
```matlab
N = 100; % Êó∂Èó¥ÊßΩÊï∞Èáè
x0 = linspace(0, 400, N)'; % ÂàùÂßã x ÂùêÊ†á
y0 = zeros(N, 1); % ÂàùÂßã y ÂùêÊ†á
H = 100 * ones(N, 1); % UAV È£ûË°åÈ´òÂ∫¶
x_o = 0; y_o = 0; x_f = 400; y_f = 0; % Ëµ∑ÁÇπÂíåÁªàÁÇπÂùêÊ†á
x_b = 200; y_b = 200; % Áî®Êà∑ÔºàdestinationÔºâÂùêÊ†á
x_e = 20; y_e = 250; x_e2 = 300; y_e2 = 50; x_e3 = 50; y_e3 = 100; % ‰∏â‰∏™Á™ÉÂê¨ËÄÖÂùêÊ†á
v = 25; % UAV ÊúÄÂ§ßÈÄüÂ∫¶ (m/s) 
```

2. ‰ø°Âô™ÊØî‰∏é‰º†ËæìÂäüÁéá
```matlab
p = 0.1 * ones(N, 1); % ‰º†ËæìÂäüÁéá 20dBm (0.1 W)
p_e = 0.1 * ones(N, 1); % Á™ÉÂê¨ËÄÖÂäüÁéá (ÂÅáËÆæÁõ∏Âêå)
gammar = 10^(11.4) * p; % Áî®Êà∑‰ø°Âô™ÊØî
gammar_e = 10^(11.4) * p_e; % Á™ÉÂê¨ËÄÖ‰ø°Âô™ÊØî
```

3. CVX ‰ºòÂåñÈóÆÈ¢ò
```matlab
cvx_begin
    variable x(n) nonnegative
    maximize(x(6*N+1))
    subject to
    for k = 1:N
        RDL = log2(1 + gammar(k) ./ ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2));
        REL = log2(1 + gammar_e(k) ./ ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2));
        REL2 = log2(1 + gammar_e(k) ./ ((x0(k)-x_e2)^2 + (y0(k)-x_e2)^2 + H(k)^2));
        REL3 = log2(1 + gammar_e(k) ./ ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2));
        
        ADL = gammar(k) ./ (log(2) * ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2 + gammar(k)) .* ((x0(k)-x_b)^2 + (y0(k)-y_b)^2 + H(k)^2));
        AEL = gammar_e(k) ./ (log(2) * ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e)^2 + (y0(k)-y_e)^2 + H(k)^2));
        AEL2 = gammar_e(k) ./ (log(2) * ((x0(k)-x_e2)^2 + (y0(k)-x_e2)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e2)^2 + (y0(k)-y_e2)^2 + H(k)^2));
        AEL3 = gammar_e(k) ./ (log(2) * ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2 + gammar_e(k)) .* ((x0(k)-x_e3)^2 + (y0(k)-x_e3)^2 + H(k)^2));
        
        BDL = -2 * (x_b - x0(k)) .* ADL;
        BEL = -2 * (x_e - x0(k)) .* AEL;
        BEL2 = -2 * (x_e2 - x0(k)) .* AEL2;
        BEL3 = -2 * (x_e3 - x0(k)) .* AEL3;
        CDL = -2 * (y_b - y0(k)) .* ADL;
        CEL = -2 * (y_e - y0(k)) .* AEL;
        CEL2 = -2 * (y_e2 - y0(k)) .* AEL2;
        CEL3 = -2 * (y_e3 - y0(k)) .* AEL3;
        
        x(2*N+k) <= RDL - ADL .* (square(x(k)) + square(x(N+k))) - BDL .* x(k) - CDL .* x(N+k);
        x(3*N+k) <= REL - AEL .* (square(x(k)) + square(x(N+k))) - BEL .* x(k) - CEL .* x(N+k);
        x(4*N+k) <= REL2 - AEL2 .* (square(x(k)) + square(x(N+k))) - BEL2 .* x(k) - CEL2 .* x(N+k);
        x(5*N+k) <= REL3 - AEL3 .* (square(x(k)) + square(x(N+k))) - BEL3 .* x(k) - CEL3 .* x(N+k);
    end   
    
    i = (2*N+1):(3*N);
    j = (3*N+1):(4*N);
    A = x(j) - x(i);
    A1 = x(j+N) - x(i);
    A2 = x(j+2*N) - x(i);
    
    for kk = 1:N
        dd = (x0(kk)-x_b)^2 + (y0(kk)-y_b)^2 + H(kk)^2;
        de1 = (x0(kk)-x_e)^2 + (y0(kk)-y_e)^2 + H(kk)^2;
        de2 = (x0(kk)-x_e2)^2 + (y0(kk)-y_e2)^2 + H(kk)^2;
        de3 = (x0(kk)-x_e3)^2 + (y0(kk)-x_e3)^2 + H(kk)^2;
        if (dd >= de1)
            A(kk) = 0;
        end
        if (dd >= de2)
            A1(kk) = 0;
        end
        if (dd >= de3)
            A2(kk) = 0;
        end
    end
    
    sum(A) <= -x(6*N+1);
    sum(A1) <= -x(6*N+1);
    sum(A2) <= -x(6*N+1);
    
    for jj = 1:N-1
        square(x0(jj+1) + x(jj+1) - x0(jj) - x(jj)) + square(y0(jj+1) + x(N+jj+1) - y0(jj) - x(N+jj)) <= v^2;
    end
    square(x0(1) + x(1) - x_o) + square(y0(1) + x(N+1) - y_o) <= v^2;
    square(x_f - x(N) - x0(N)) + square(y_f - x(N+N) - y0(N)) <= v^2;
cvx_end
```

4. UAVËΩ®Ëøπ‰ºòÂåñ‰ª•Âèä‰øùÂØÜÈÄüÁéáËÆ°ÁÆó
```matlab
% Êõ¥Êñ∞UAVË∑ØÂæÑ
x0 = x0 + x(1:N);
y0 = y0 + x(N+1:2*N);

% ËÆ°ÁÆó‰øùÂØÜÈÄüÁéá
rate = []; rate_u = []; rate_e0 = [];
for l = 1:size(x0,1)   
    rate_u = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_b-x0(l))^2 + (y_b-y0(l))^2));
    rate_e = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e-x0(l))^2 + (y_e-y0(l))^2));
    rate_e2 = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e2-x0(l))^2 + (y_e2-y0(l))^2));
    rate_e3 = log2(1 + 10^(11.4) * 0.1 / (100^2 + (x_e3-x0(l))^2 + (y_e3-y0(l))^2));
    rate_e0 = max([rate_e, rate_e2, rate_e3]);
    rate(l) = max(rate_u - rate_e0, 0);
end
secrecy_rate(mm) = sum(rate);
```

>[!important]
> ‰ºòÂåñÂèòÈáèÔºö
> - x(1:N)Ôºö$u_x(n)$Ôºå$x$ ÊñπÂêëËΩ®ËøπÂ¢ûÈáè„ÄÇ
> - x(N+1:2*N)Ôºö$u_y(n)$Ôºå$y$ ÊñπÂêëËΩ®ËøπÂ¢ûÈáè„ÄÇ
> - x(2*N+1:3*N)Ôºö$R_d(n)$ ÁöÑ‰∏ãÁïå„ÄÇ
> - x(3*N+1:4*N)Ôºö$R_e^1(n)$ ÁöÑ‰∏ãÁïå„ÄÇ
> - x(4*N+1:5*N)Ôºö$R_e^2(n)$ ÁöÑ‰∏ãÁïå„ÄÇ
> - x(5*N+1:6*N)Ôºö$R_e^3(n)$ ÁöÑ‰∏ãÁïå„ÄÇ
> - x(6*N+1)ÔºöÁõÆÊ†áÂÄºÔºåË°®Á§∫ $\min_{k} \sum_{n=1}^N R_s^k(n)$„ÄÇ

---

[//]: # (## ÂéüËÆ∫ÊñáÊ®°Âûã)

[//]: # (### 1. Á≥ªÁªüÊ®°Âûã‰∏é‰ø°ÈÅìÊ®°Âûã)

[//]: # ()
[//]: # (#### 1.1 ËäÇÁÇπ‰ΩçÁΩÆÂÆö‰πâ)

[//]: # (Âú®‰∏Ä‰∏™‰∏âÁª¥Á¨õÂç°Â∞îÂùêÊ†áÁ≥ª‰∏≠Ôºö)

[//]: # (- Âú∞Èù¢È´òÂ∫¶ÂÆö‰πâ‰∏∫ 0ÔºåÊó†‰∫∫Êú∫ÔºàUAVÔºâÈ£ûË°åÈ´òÂ∫¶Âõ∫ÂÆö‰∏∫ $H$„ÄÇ)

[//]: # (- Á™ÉÂê¨ËÄÖ‰ΩçÁΩÆÔºö$\mathcal{L}_e^k = &#40;e_x^k, e_y^k, 0&#41;, k = 1, \ldots, K$„ÄÇ)

[//]: # (- ÁõÆÊ†á‰ΩçÁΩÆÔºö$\mathcal{L}_d = &#40;d_x, d_y, 0&#41;$„ÄÇ)

[//]: # (- UAV ËΩ®ËøπÁ¶ªÊï£Âåñ‰∏∫ $N$ ‰∏™ÈîöÁÇπÔºö$\mathcal{L}_u&#40;n&#41; = &#40;u_x&#40;n&#41;, u_y&#40;n&#41;, H&#41;, n = 1, \ldots, N$„ÄÇ)

[//]: # (- ÂàùÂßãÂíåÊúÄÁªà‰ΩçÁΩÆÂàÜÂà´‰∏∫Ôºö$\mathcal{L}_u&#40;I&#41; = &#40;u_x&#40;I&#41;, u_y&#40;I&#41;, H&#41;$ Âíå $\mathcal{L}_u&#40;F&#41; = &#40;u_x&#40;F&#41;, u_y&#40;F&#41;, H&#41;$„ÄÇ)

[//]: # ()
[//]: # (#### 1.2 Ë∑ùÁ¶ªËÆ°ÁÆó)

[//]: # (UAV ‰∏éÁõÆÊ†á‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºö)

[//]: # ($$)

[//]: # (s_d&#40;n&#41; = \|\mathcal{L}_u&#40;n&#41; - \mathcal{L}_d\|_2, \quad n = 1, \ldots, N)

[//]: # ($$)

[//]: # (UAV ‰∏éÁ¨¨ $k$ ‰∏™Á™ÉÂê¨ËÄÖ‰πãÈó¥ÁöÑË∑ùÁ¶ªÔºö)

[//]: # ($$)

[//]: # (s_e^k&#40;n&#41; = \|\mathcal{L}_u&#40;n&#41; - \mathcal{L}_e^k\|_2, \quad k = 1, \ldots, K, \, n = 1, \ldots, N)

[//]: # ($$)

[//]: # ()
[//]: # (#### 1.3 ‰ø°ÈÅìÂ¢ûÁõä)

[//]: # (ÈááÁî®Ëá™Áî±Á©∫Èó¥Ë∑ØÂæÑÊçüËÄóÊ®°ÂûãÔºå‰ø°ÈÅìÂ¢ûÁõä‰∏∫Ôºö)

[//]: # (- UAV Âà∞ÁõÆÊ†áÔºö)

[//]: # (  $$)

[//]: # (  h_d&#40;n&#41; = \alpha_0 s_d&#40;n&#41;^{-2}, \quad n = 1, \ldots, N)

[//]: # (  $$)

[//]: # (- UAV Âà∞Á¨¨ $k$ ‰∏™Á™ÉÂê¨ËÄÖÔºö)

[//]: # (  $$)

[//]: # (  h_e^k&#40;n&#41; = \alpha_0 s_e^k&#40;n&#41;^{-2}, \quad k = 1, \ldots, K, \, n = 1, \ldots, N)

[//]: # (  $$)

[//]: # (  ÂÖ∂‰∏≠Ôºå$\alpha_0$ ÊòØÂèÇËÄÉË∑ùÁ¶ª 1 Á±≥Â§ÑÁöÑÊúâÊïà‰ø°ÈÅìÂäüÁéáÂ¢ûÁõä„ÄÇ)

[//]: # ()
[//]: # (#### 1.4 Áû¨Êó∂‰º†ËæìÈÄüÁéá)

[//]: # (UAV Âà∞ÁõÆÊ†áÁöÑÁû¨Êó∂‰º†ËæìÈÄüÁéáÔºö)

[//]: # ($$)

[//]: # (R_d&#40;n&#41; = \log_2\left&#40;1 + \frac{h_d&#40;n&#41; p}{\sigma^2}\right&#41;)

[//]: # ($$)

[//]: # (Á¨¨ $k$ ‰∏™Á™ÉÂê¨ËÄÖÁöÑÁû¨Êó∂Ê≥ÑÊºèÈÄüÁéáÔºö)

[//]: # ($$)

[//]: # (R_e^k&#40;n&#41; = \log_2\left&#40;1 + \frac{h_e^k&#40;n&#41; p}{\sigma^2}\right&#41;)

[//]: # ($$)

[//]: # (ÂÖ∂‰∏≠Ôºå$p$ ÊòØÁû¨Êó∂ÂèëÂ∞ÑÂäüÁéáÔºå$\sigma^2$ ÊòØÂä†ÊÄßÁôΩÈ´òÊñØÂô™Â£∞ÔºàAWGNÔºâÁöÑÂäüÁéá„ÄÇ)

[//]: # ()
[//]: # (#### 1.5 ‰øùÂØÜÈÄüÁéá)

[//]: # (ÈíàÂØπÁ¨¨ $k$ ‰∏™Á™ÉÂê¨ËÄÖÁöÑ‰øùÂØÜÈÄüÁéáÂÆö‰πâ‰∏∫Ôºö)

[//]: # ($$)

[//]: # (R_s^k&#40;n&#41; = [R_d&#40;n&#41; - R_e^k&#40;n&#41;]^+)

[//]: # ($$)

[//]: # (ÂÖ∂‰∏≠Ôºå$[x]^+ = \max&#40;x, 0&#41;$„ÄÇ)

[//]: # ()
[//]: # (---)

[//]: # ()
[//]: # (### 2. ÈóÆÈ¢òÂΩ¢ÂºèÂåñ)

[//]: # ()
[//]: # (#### 2.1 ‰ºòÂåñÁõÆÊ†á)

[//]: # (ÁõÆÊ†áÊòØÊúÄÂ§ßÂåñÁ≥ªÁªü‰∏≠ÊúÄÂ∞èÂèØÂÆûÁé∞ÁöÑ‰øùÂØÜÈÄüÁéáÔºàËÄÉËôëÊúÄÂùèÊÉÖÂÜµÔºâÔºå‰ºòÂåñÈóÆÈ¢ò $\mathbf{P0}$ Ë°®Á§∫‰∏∫Ôºö)

[//]: # ($$)

[//]: # (\mathbf{P0}: \max_{\{u_x&#40;n&#41;, u_y&#40;n&#41;\}} \min_{k} \sum_{n=1}^N R_s^k&#40;n&#41;)

[//]: # ($$)

[//]: # ()
[//]: # (#### 2.2 Á∫¶ÊùüÊù°‰ª∂)

[//]: # (- ÂàùÂßã‰ΩçÁΩÆÁ∫¶ÊùüÔºö)

[//]: # (  $$)

[//]: # (  \|\mathcal{L}_u&#40;1&#41; - \mathcal{L}_u&#40;I&#41;\|_2 \leq v \tau)

[//]: # (  $$)

[//]: # (- ËøûÁª≠Êó∂Èó¥ÊßΩÁöÑÁßªÂä®Á∫¶ÊùüÔºö)

[//]: # (  $$)

[//]: # (  \|\mathcal{L}_u&#40;n&#41; - \mathcal{L}_u&#40;n-1&#41;\|_2 \leq v \tau, \quad n = 2, \ldots, N)

[//]: # (  $$)

[//]: # (- ÊúÄÁªà‰ΩçÁΩÆÁ∫¶ÊùüÔºö)

[//]: # (  $$)

[//]: # (  \|\mathcal{L}_u&#40;N&#41; - \mathcal{L}_u&#40;F&#41;\|_2 \leq v \tau)

[//]: # (  $$)

[//]: # (  ÂÖ∂‰∏≠Ôºå$v$ ÊòØ UAV ÁöÑÊúÄÂ§ßÁû¨Êó∂ÈÄüÂ∫¶Ôºå$\tau$ ÊòØÊØè‰∏™Êó∂Èó¥ÊßΩÁöÑÈïøÂ∫¶Ôºå$v \tau$ Ë°®Á§∫ UAV Âú®‰∏Ä‰∏™Êó∂Èó¥ÊßΩÂÜÖÂèØÁßªÂä®ÁöÑÊúÄÂ§ßË∑ùÁ¶ª„ÄÇ)

[//]: # ()
[//]: # (Áî±‰∫é $R_s^k&#40;n&#41;$ ÁöÑÈùûÂá∏ÊÄßÂíå‰∏çÂèØÂØºÊÄßÔºå$\mathbf{P0}$ ÊòØ‰∏Ä‰∏™ÈùûÂá∏‰ºòÂåñÈóÆÈ¢ò„ÄÇ)

[//]: # ()
[//]: # (---)

[//]: # ()
[//]: # (### 3. ËΩ®Ëøπ‰ºòÂåñ)

[//]: # ()
[//]: # (#### 3.1 ÂèòÈáèÂèòÊç¢)

[//]: # (‰∏∫‰∫ÜÁÆÄÂåñ‰ºòÂåñÔºåÁõ¥Êé•‰ºòÂåñËΩ®ËøπÈîöÁÇπ $&#40;u_x&#40;n&#41;, u_y&#40;n&#41;&#41;$ ËæÉÂõ∞ÈöæÔºåÂõ†Ê≠§ÂºïÂÖ•ËΩ®ËøπÂ¢ûÈáèÂèòÈáèÔºö)

[//]: # (- Âú®Á¨¨ $i-1$ Ê¨°Ëø≠‰ª£‰∏≠ÔºåÁ¨¨ $n$ ‰∏™ÈîöÁÇπÁöÑËΩ®ËøπÂ¢ûÈáè‰∏∫ $\{\zeta&#40;i-1, n&#41; \geq 0, \nu&#40;i-1, n&#41; \geq 0\}$„ÄÇ)

[//]: # (- Á¨¨ $i$ Ê¨°Ëø≠‰ª£ÁöÑËΩ®ËøπÈîöÁÇπÊõ¥Êñ∞‰∏∫Ôºö)

[//]: # (  $$)

[//]: # (  u_x&#40;i, n&#41; = u_x&#40;i-1, n&#41; + \zeta&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  u_y&#40;i, n&#41; = u_y&#40;i-1, n&#41; + \nu&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # ()
[//]: # (#### 3.2 ‰∏ãÁïåËøë‰ºº)

[//]: # (ÂØπ $R_d&#40;n&#41;$ Âíå $R_e^k&#40;n&#41;$ ËøõË°å‰∏ãÁïåËøë‰ººÔºö)

[//]: # (- UAV Âà∞ÁõÆÊ†áÁöÑ‰º†ËæìÈÄüÁéá‰∏ãÁïåÔºö)

[//]: # (  $$)

[//]: # (  R_d^{lb}&#40;i, n&#41; = R_d&#40;i-1, n&#41; - a_d&#40;i-1, n&#41; [&#40;\zeta&#40;i-1, n&#41;&#41;^2 + &#40;\nu&#40;i-1, n&#41;&#41;^2] - b_d&#40;i-1, n&#41; \zeta&#40;i-1, n&#41; - c_d&#40;i-1, n&#41; \nu&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (- Á¨¨ $k$ ‰∏™Á™ÉÂê¨ËÄÖÁöÑÊ≥ÑÊºèÈÄüÁéá‰∏ãÁïåÔºö)

[//]: # (  $$)

[//]: # (  R_e^{k,lb}&#40;i, n&#41; = R_e^k&#40;i-1, n&#41; - a_e^k&#40;i-1, n&#41; [&#40;\zeta&#40;i-1, n&#41;&#41;^2 + &#40;\nu&#40;i-1, n&#41;&#41;^2] - b_e^k&#40;i-1, n&#41; \zeta&#40;i-1, n&#41; - c_e^k&#40;i-1, n&#41; \nu&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (  ÂÖ∂‰∏≠ÔºåÁ≥ªÊï∞ÂÆö‰πâÂ¶Ç‰∏ãÔºö)

[//]: # (  $$)

[//]: # (  a_d&#40;i-1, n&#41; = \frac{p}{\ln 2 [\alpha_0 \sigma^2 s_d&#40;i-1, n&#41;^4 + p s_d&#40;i-1, n&#41;^2]})

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  b_d&#40;i-1, n&#41; = 2 &#40;u_x&#40;i-1, n&#41; - d_x&#41; a_d&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  c_d&#40;i-1, n&#41; = 2 &#40;u_y&#40;i-1, n&#41; - d_y&#41; a_d&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  a_e^k&#40;i-1, n&#41; = \frac{p}{\ln 2 [\alpha_0 \sigma^2 s_e^k&#40;i-1, n&#41;^4 + p s_e^k&#40;i-1, n&#41;^2]})

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  b_e^k&#40;i-1, n&#41; = 2 &#40;u_x&#40;i-1, n&#41; - e_x^k&#41; a_e^k&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # (  $$)

[//]: # (  c_e^k&#40;i-1, n&#41; = 2 &#40;u_y&#40;i-1, n&#41; - e_y^k&#41; a_e^k&#40;i-1, n&#41;)

[//]: # (  $$)

[//]: # ()
[//]: # (#### 3.3 ‰ºòÂåñÈóÆÈ¢òÈáçÂÜô)

[//]: # (Âü∫‰∫é‰∏ãÁïåÔºå$\mathbf{P0}$ Âú®Á¨¨ $i$ Ê¨°Ëø≠‰ª£‰∏≠ÈáçÂÜô‰∏∫ $\mathbf{P0}^{&#40;1&#41;}$Ôºö)

[//]: # ($$)

[//]: # (\mathbf{P0}^{&#40;1&#41;}: \max_{\{\zeta&#40;n&#41;, \nu&#40;n&#41;, R_d&#40;i,n&#41;, R_e^k&#40;i,n&#41;\}} \min_{k} \sum_{n=1}^N [R_d&#40;i,n&#41; - R_e^k&#40;i,n&#41;]^+)

[//]: # ($$)

[//]: # (Á∫¶ÊùüÊù°‰ª∂Ôºö)

[//]: # ($$)

[//]: # (R_d&#40;i,n&#41; \leq R_d^{lb}&#40;i,n&#41;, \quad n = 1, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (R_e^k&#40;i,n&#41; \leq R_e^{k,lb}&#40;i,n&#41;, \quad k = 1, \ldots, K, \, n = 1, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;1&#41; + \Phi&#40;1&#41; - \mathcal{L}_u&#40;I&#41;\|_2 \leq v \tau)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;n&#41; + \Phi&#40;n&#41; - \mathcal{L}_u&#40;n-1&#41; - \Phi&#40;n-1&#41;\|_2 \leq v \tau, \quad n = 2, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;N&#41; + \Phi&#40;N&#41; - \mathcal{L}_u&#40;F&#41;\|_2 \leq v \tau)

[//]: # ($$)

[//]: # (ÂÖ∂‰∏≠Ôºå$\Phi&#40;n&#41; = &#40;\zeta&#40;n&#41;, \nu&#40;n&#41;, 0&#41;$ Ë°®Á§∫ËΩ®ËøπÂ¢ûÈáèÂêëÈáè„ÄÇ)

[//]: # ()
[//]: # (Áî±‰∫é $R_d^{lb}&#40;i,n&#41;$ Âíå $R_e^{k,lb}&#40;i,n&#41;$ ÊòØÂáπ‰∫åÊ¨°ÂáΩÊï∞Ôºå$\mathbf{P0}^{&#40;1&#41;}$ Êª°Ë∂≥Âá∏ÊÄßÔºå‰ΩÜ‰ªç‰∏çÂèØÂØº„ÄÇ)

[//]: # ()
[//]: # (---)

[//]: # ()
[//]: # (### 4. Hypograph ÂèòÊç¢)

[//]: # ()
[//]: # (#### 4.1 Hypograph ÂÆö‰πâ)

[//]: # (ÂÆö‰πâÁõÆÊ†áÂáΩÊï∞ $f = \sum_{n=1}^N R_s^k&#40;i,n&#41;$ÔºåÂÖ∂ hypograph ‰∏∫Ôºö)

[//]: # ($$)

[//]: # (\text{hypo } f = \{&#40;\{\zeta&#40;n&#41;, \nu&#40;n&#41;, R_d&#40;i,n&#41;, R_e^k&#40;i,n&#41;\}, R^*&#41; \mid f \geq R^*\})

[//]: # ($$)

[//]: # (Áî±‰∫é $f$ ÊòØÁ∫øÊÄßÂáΩÊï∞Ôºå$\text{hypo } f$ ÊòØÂá∏ÈõÜ„ÄÇ)

[//]: # ()
[//]: # (#### 4.2 ‰ºòÂåñÈóÆÈ¢òÈáçÊûÑ)

[//]: # (Âü∫‰∫é hypographÔºåÈóÆÈ¢ò $\mathbf{P0}^{&#40;1&#41;}$ ËΩ¨Âåñ‰∏∫Ê†áÂáÜÂá∏‰ºòÂåñÈóÆÈ¢ò $\mathbf{P1}^{&#40;1&#41;}$Ôºö)

[//]: # ($$)

[//]: # (\mathbf{P1}^{&#40;1&#41;}: \max_{\{\zeta&#40;n&#41;, \nu&#40;n&#41;, R^*, R_d&#40;i,n&#41;, R_e^k&#40;i,n&#41;\}} R^*)

[//]: # ($$)

[//]: # (Á∫¶ÊùüÊù°‰ª∂Ôºö)

[//]: # ($$)

[//]: # (\sum_{n=1}^N R_s^k&#40;i,n&#41; \geq R^*, \quad k = 1, \ldots, K)

[//]: # ($$)

[//]: # ($$)

[//]: # (R_d&#40;i,n&#41; \leq R_d^{lb}&#40;i,n&#41;, \quad n = 1, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (R_e^k&#40;i,n&#41; \leq R_e^{k,lb}&#40;i,n&#41;, \quad k = 1, \ldots, K, \, n = 1, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;1&#41; + \Phi&#40;1&#41; - \mathcal{L}_u&#40;I&#41;\|_2 \leq v \tau)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;n&#41; + \Phi&#40;n&#41; - \mathcal{L}_u&#40;n-1&#41; - \Phi&#40;n-1&#41;\|_2 \leq v \tau, \quad n = 2, \ldots, N)

[//]: # ($$)

[//]: # ($$)

[//]: # (\|\mathcal{L}_u&#40;N&#41; + \Phi&#40;N&#41; - \mathcal{L}_u&#40;F&#41;\|_2 \leq v \tau)

[//]: # ($$)

[//]: # ()
[//]: # ($\mathbf{P1}^{&#40;1&#41;}$ ÊòØ‰∏Ä‰∏™Ê†áÂáÜÁöÑÂá∏‰∫åÊ¨°ËßÑÂàíÈóÆÈ¢òÔºåÂèØ‰ΩøÁî®Áé∞ÊúâÂ∑•ÂÖ∑ÔºàÂ¶Ç CVXÔºâÈ´òÊïàÊ±ÇËß£„ÄÇ)


## Ê†áÂáÜ
### ÂÖÉÁ¥†ÂùêÊ†á‰∏éÁ≥ªÁªüÊ®°Âûã
Âü∫Êú¨ÂùêÊ†á‰ø°ÊÅØÔºö
>[!info]
> - UAV ‰ΩçÁΩÆÔºö$\mathcal{L}_u(n) = (u_x(n), u_y(n), H)$
> - Áî®Êà∑‰ΩçÁΩÆÔºö$\mathcal{L}_d = (d_x, d_y, 0)$
> - RIS ‰ΩçÁΩÆÔºö$\mathcal{L}_r = (r_x, r_y, H_r)$
> - RIS Áõ∏‰ΩçË∞ÉÊï¥Áü©ÈòµÔºö$\Phi(n) = \text{diag}(e^{j\theta_1(n)}, \ldots, e^{j\theta_M(n)})$Ôºå$M$ ‰∏∫ÂèçÂ∞ÑÂçïÂÖÉÊï∞„ÄÇ

Á≥ªÁªüÁªÑÊàêÔºö
>[!info]
> - UAV ‰ΩçÁΩÆÔºö$\mathcal{L}_u(n) = (u_x(n), u_y(n), H)$
> - Áî®Êà∑‰ΩçÁΩÆÔºö$\mathcal{L}_d = (d_x, d_y, 0)$
> - RIS ‰ΩçÁΩÆÔºö$\mathcal{L}_r = (r_x, r_y, H_r)$
> - RIS Áõ∏‰ΩçË∞ÉÊï¥Áü©ÈòµÔºö$\Phi(n) = \text{diag}(e^{j\theta_1(n)}, \ldots, e^{j\theta_M(n)})$Ôºå$M$ ‰∏∫ÂèçÂ∞ÑÂçïÂÖÉÊï∞„ÄÇ

Ë∑ùÁ¶ªÂÆö‰πâÔºö
>[!info]
> - UAV Âà∞Áî®Êà∑Ôºö$s_d(n) = ||\mathcal{L}_u(n) - \mathcal{L}_d||_2$
> - UAV Âà∞ RISÔºö$s_{u,r}(n) = ||\mathcal{L}_u(n) - \mathcal{L}_r||_2$
> - RIS Âà∞Áî®Êà∑Ôºö$s_{r,d} = ||\mathcal{L}_r - \mathcal{L}_d||_2$


### ‰ø°ÈÅìÂ¢ûÁõäÊé®ÂØºÔºàÊ†áÂáÜÂπÖÂ∫¶ÂΩ¢ÂºèÔºâ

==Áõ¥Êé•‰ø°ÈÅì(UAV --> User)==

Ê†πÊçÆËá™Áî±Á©∫Èó¥Ë∑ØÂæÑÊçüËÄóÊ®°ÂûãÔºå

‰ø°ÈÅìÂäüÁéáÂ¢ûÁõä‰∏∫Ôºö $|h_d(n)|^2 = \alpha_0 s_d(n)^{-2}$

‰ø°ÈÅìÂπÖÂ∫¶‰∏∫Ôºö ==$h_d(n) = \sqrt{|h_d(n)|^2} = \sqrt{\alpha_0 s_d(n)^{-2}} = \sqrt{\alpha_0} s_d(n)^{-1}$=={.tip}

==ÂèçÂ∞Ñ‰ø°ÈÅì(UAV --> RIS, RIS --> User)==
>[!important]
>RIS ÂèçÂ∞Ñ‰ø°ÈÅìÁî± UAV Âà∞ RIS Âíå RIS Âà∞Áî®Êà∑ÁöÑÁ∫ßËÅîÁªÑÊàê„ÄÇ

:::steps
1. UAV -> RISÔºö

Ë∑ùÁ¶ª $s_{u,r}(n)$ÔºåÂäüÁéáÂ¢ûÁõäÔºö $|\mathbf{h}_{u,r}(n)|^2 = \alpha_0 s_{u,r}(n)^{-2}$

ÂπÖÂ∫¶Ôºö $\mathbf{h}_{u,r}(n) = \sqrt{\alpha_0} s_{u,r}(n)^{-1} \mathbf{a}_{u,r}(n)$ 
>ÂÖ∂‰∏≠ $\mathbf{a}_{u,r}(n)$ ÊòØ RIS ÁöÑÈòµÂàóÂìçÂ∫îÂêëÈáèÔºåÈïøÂ∫¶‰∏∫ $M$ÔºåÊ®°‰∏∫ 1„ÄÇ

2. RIS -> UserÔºö

Ë∑ùÁ¶ª $s_{r,d}$ÔºåÂäüÁéáÂ¢ûÁõäÔºö $|\mathbf{h}_{r,d}(n)|^2 = \alpha_0 s_{r,d}(n)^{-2}$

ÂπÖÂ∫¶Ôºö $\mathbf{h}_{r,d} = \sqrt{\alpha_0} s_{r,d}(n)^{-1} \mathbf{a}_{r,d}(n)$ 
>ÂÖ∂‰∏≠$\mathbf{a}_{r,d}(n)$ ‰∏∫ RIS Âà∞Áî®Êà∑ÁöÑÈòµÂàóÂìçÂ∫îÂêëÈáè„ÄÇ

3. UAV -> RIS -> UserÔºö

ÊÄª‰ø°ÈÅì‰∏∫Ôºö $h_r(n) = \mathbf{h}_{r,d}(n)^T \Phi(n) \mathbf{h}_{u,r}(n)$

‰ª£ÂÖ•Ôºö $h_r(n) = (\sqrt{\alpha_0} s_{r,d}(n)^{-1} \mathbf{a}_{r,d})^T \Phi(n) (\sqrt{\alpha_0} s_{u,r}(n)^{-1} \mathbf{a}_{u,r}(n))$

ÂåñÁÆÄÔºö ==$h_r(n) = \alpha_0 s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \{\mathbf{a}_{r,d}^T \Phi(n) \mathbf{a}_{u,r}(n)\}$=={.tip}

:::

==ÊÄª‰ø°ÈÅì $h_{\text{total}}(n)$==

ÊÄª‰ø°ÈÅìÂ¢ûÁõä‰∏∫Áõ¥Êé•‰ø°ÈÅìÂíåÂèçÂ∞Ñ‰ø°ÈÅìÁöÑÁõ∏Âπ≤Âè†Âä†Ôºö $h_{\text{total}}(n) = h_d(n) + h_r(n)$

‰ª£ÂÖ•Ôºö ==$h_{\text{total}}(n) = \sqrt{\alpha_0} s_d(n)^{-1} + \alpha_0 s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \mathbf{a}_{r,d}(n)^T \Phi(n) \mathbf{a}_{u,r}(n)$=={.danger}

>[!note]
>$h_d(n)$ Âíå $h_r(n)$ ÁöÑÁõ∏‰ΩçÊú™ÊòæÂºèËÄÉËôë„ÄÇËã•ÈúÄÁ≤æÁ°ÆËÆ°ÁÆóÔºåÂ∫îÂºïÂÖ•Áõ∏‰ΩçÈ°πÔºå‰ΩÜ‰ºòÂåñ‰∏≠ÈÄöÂ∏∏ÈÄöËøá $\Phi(n)$ Ë∞ÉÊï¥Áõ∏‰ΩçÂØπÈΩê„ÄÇ


### Êé•Êî∂ÂäüÁéá $P_d$ Êé®ÂØº
Êé•Êî∂ÂäüÁéáÂÆö‰πâ‰∏∫Ôºö $P_d(n) = p |h_{\text{total}}(n)|^2$

‰ª£ÂÖ• $h_{\text{total}}(n)$ÔºåËÆ°ÁÆóÂäüÁéáÔºö 

$|h_{\text{total}}(n)|^2 = \left| \sqrt{\alpha_0} s_d(n)^{-1} + \alpha_0 s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \mathbf{a}_{r,d}(n)^T \Phi(n) \mathbf{a}_{u,r}(n) \right|^2$

‰ª§ $g_r(n) = \mathbf{a}_{r,d}(n)^T \Phi(n) \mathbf{a}_{u,r}(n)$ÔºàÂ§çÊï∞ÔºâÔºåÂàôÔºö 

$|h_{\text{total}}(n)|^2 = \alpha_0 s_d(n)^{-2} + 2 \sqrt{\alpha_0} \alpha_0 s_d(n)^{-1} s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \text{Re}\{g_r(n)\} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} |g_r(n)|^2$

Âõ†Ê≠§Ôºö 

$P_d(n) = p|h_{\text{total}}(n)|^2 = p \left( \alpha_0 s_d(n)^{-2} + 2 \sqrt{\alpha_0} \alpha_0 s_d(n)^{-1} s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \text{Re}\{g_r(n)\} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} |g_r(n)|^2 \right)$


### ÈÄüÁéáËÆ°ÁÆó
Áî®Êà∑‰º†ËæìÈÄüÁéáÔºö $R_d(n) = \log_2 \left( 1 + \frac{P_d(n)}{\sigma^2} \right)$

‰ª£ÂÖ• $P_d(n)$Ôºö 
==$R_d(n)$ = $\log_2(1 + \frac{p \left( \alpha_0 s_d(n)^{-2} + 2 \sqrt{\alpha_0} \alpha_0 s_d(n)^{-1} s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \text{Re}\{g_r(n)\} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} |g_r(n)|^2 \right)}{\sigma^2})$=={.danger}

### ÂèØËÉΩÁöÑÊ®°ÂûãÁÆÄÂåñ
Áõ∏‰ΩçÂØπÈΩêÔºö

$g_r(n) = \mathbf{a}_{r,d}(n)^T \Phi(n) \mathbf{a}_{u,r}(n)$ ÁöÑÂÄºÂèñÂÜ≥‰∫é RIS Áõ∏‰ΩçË∞ÉÊï¥„ÄÇ

Ëã• $\Phi(n)$ ‰ºòÂåñ‰Ωø $g_r(n)$ ‰∏é $h_d(n)$ ÂêåÁõ∏ÔºåÂàô $\text{Re}\{g_r(n)\}$ ÊúÄÂ§ßÂåñÔºåÂ¢ûÂº∫‰ø°Âè∑„ÄÇ

ÁÆÄÂåñÂΩ¢ÂºèÔºö

Ëã•ÂøΩÁï•Áõ∏‰ΩçÔºåÊàñÂÅáËÆæ $g_r(n)$ Â∑≤‰ºòÂåñ‰∏∫ÂÆûÊï∞ÔºàÂ¶Ç $|g_r(n)| \leq M$ÔºâÔºå

ÂèØËøë‰ºº‰∏∫Ôºö 

$P_d(n) \approx p \left( \alpha_0 s_d(n)^{-2} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} M^2 \right)$

‰ª£ÂÖ• $P_d(n)$Ôºö
==$R_d(n) = \log_2(1 + \frac{p \left( \alpha_0 s_d(n)^{-2} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} M^2 \right)}{\sigma^2})$=={.danger}

### ÂÖ¨ÂºèÊÄªÁªì
> 1. $h_{\text{total}}(n) = \sqrt{\alpha_0} s_d(n)^{-1} + \alpha_0 s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \mathbf{a}_{r,d}(n)^T \Phi(n) \mathbf{a}_{u,r}(n)$


> 2. $P_d(n) = p \left( \alpha_0 s_d(n)^{-2} + 2 \sqrt{\alpha_0} \alpha_0 s_d(n)^{-1} s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \text{Re}\{g_r(n)\} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} |g_r(n)|^2 \right)$


> 3. $R_d(n)$ = $\log_2(1 + \frac{p \left( \alpha_0 s_d(n)^{-2} + 2 \sqrt{\alpha_0} \alpha_0 s_d(n)^{-1} s_{u,r}(n)^{-1} s_{r,d}(n)^{-1} \text{Re}\{g_r(n)\} + \alpha_0^2 s_{u,r}(n)^{-2} s_{r,d}(n)^{-2} |g_r(n)|^2 \right)}{\sigma^2})$
















































[//]: # (```matlab)

[//]: # (% Ê∏ÖÁ©∫Â∑•‰ΩúÂå∫ÂèòÈáèÔºåÂÖ≥Èó≠ÊâÄÊúâÂõæÂΩ¢Á™óÂè£)

[//]: # (clc)

[//]: # (clear all)

[//]: # (close all)

[//]: # ()
[//]: # (% ÂàùÂßãÂåñÂèÇÊï∞)

[//]: # (N = 100;                    % Ë∑ØÂæÑÁÇπÁöÑÊï∞Èáè)

[//]: # (x0 = linspace&#40;0, 400, N&#41;';  % ÂàùÂßãxÂùêÊ†áÔºå‰ªé0Âà∞400Á∫øÊÄßÂàÜÂ∏É)

[//]: # (y0 = zeros&#40;N, 1&#41;;          % ÂàùÂßãyÂùêÊ†áÔºåÂÖ®ÈÉ®‰∏∫0)

[//]: # (H = 100 * ones&#40;N, 1&#41;;      % Êó†‰∫∫Êú∫È£ûË°åÈ´òÂ∫¶ÔºåÂõ∫ÂÆö‰∏∫100Á±≥)

[//]: # (x_o = 0; y_o = 0;          % Ëµ∑ÁÇπÂùêÊ†á &#40;0,0&#41;)

[//]: # (x_f = 400; y_f = 0;        % ÁªàÁÇπÂùêÊ†á &#40;400,0&#41;)

[//]: # (x_b = 200; y_b = 200;      % Áî®Êà∑‰ΩçÁΩÆÂùêÊ†á &#40;200,200&#41;)

[//]: # (x_e = 50; y_e = 250;       % Á™ÉÂê¨ËÄÖ1‰ΩçÁΩÆÂùêÊ†á &#40;50,250&#41;)

[//]: # (x_e2 = 300; y_e2 = 50;     % Á™ÉÂê¨ËÄÖ2‰ΩçÁΩÆÂùêÊ†á &#40;300,50&#41;)

[//]: # (x_e3 = 50; y_e3 = 100;     % Á™ÉÂê¨ËÄÖ3‰ΩçÁΩÆÂùêÊ†á &#40;50,100&#41;)

[//]: # (v = 20;                    % Êó†‰∫∫Êú∫ÊúÄÂ§ßÈÄüÂ∫¶ÈôêÂà∂ &#40;Á±≥/Áßí&#41;)

[//]: # (x_r = 200; y_r = 100; H_r = 30;    % RIS‰ΩçÁΩÆÂùêÊ†á&#40;200,100,30&#41;)

[//]: # (M = 64;                    % RISÂèçÂ∞ÑÂçïÂÖÉÊï∞Èáè)

[//]: # (beta = 0.85;               % RISÊØè‰∏™ÂçïÂÖÉÁöÑÂèçÂ∞ÑÂ¢ûÁõä)

[//]: # ()
[//]: # (% ÂàùÂßãÂåñRISÁõ∏‰ΩçÂêëÈáèÔºàÈöèÊú∫ÂàùÂßãÂåñÔºâ)

[//]: # (theta = 2 * pi * rand&#40;M, 1&#41;;  % ÂàùÂßãÁõ∏‰ΩçÔºåËåÉÂõ¥[0, 2pi&#41;)

[//]: # ()
[//]: # (% Áî®‰∫éÂ≠òÂÇ®ÊØèÊ¨°Ëø≠‰ª£ÁöÑ‰øùÂØÜÈÄüÁéá)

[//]: # (secrecy_rate = zeros&#40;1, 5&#41;;)

[//]: # ()
[//]: # (% ‰∏ª‰ºòÂåñÂæ™ÁéØÔºåÊâßË°å5Ê¨°Ëø≠‰ª£)

[//]: # (for mm = 1:5)

[//]: # (    % ÂàùÂßãÂåñÂäüÁéáÂèÇÊï∞)

[//]: # (    p = 0.1 * ones&#40;N, 1&#41;;      % ‰º†ËæìÂäüÁéá20dBm &#40;0.1 W&#41;)

[//]: # (    p_e = 0.1 * ones&#40;N, 1&#41;;    % Á™ÉÂê¨ËÄÖÂäüÁéáÔºàËøôÈáåÂÅáËÆæ‰∏éÁî®Êà∑Áõ∏ÂêåÔºâ)

[//]: # (    alpha0 = 10^&#40;-5&#41;;          % ÂèÇËÄÉË∑ùÁ¶ª1Á±≥Êó∂ÁöÑ‰ø°ÈÅìÂäüÁéáÂ¢ûÁõä)

[//]: # (    sigma2 = 10^&#40;-11.4&#41;;       % È´òÊñØÁôΩÂô™Â£∞ÂäüÁéá)

[//]: # (    )
[//]: # (    % CVX‰ºòÂåñÈÉ®ÂàÜ - ‰ΩøÁî®Âá∏‰ºòÂåñÊ±ÇËß£Êó†‰∫∫Êú∫ËΩ®Ëøπ)

[//]: # (    n = 6 * N + 1;             % ÂèòÈáèÊÄªÊï∞)

[//]: # (    cvx_begin)

[//]: # (        variable x&#40;n&#41; nonnegative  % ÂÆö‰πâÈùûË¥ü‰ºòÂåñÂèòÈáè)

[//]: # (        maximize&#40;x&#40;6*N+1&#41;&#41;        % ÁõÆÊ†áÔºöÊúÄÂ§ßÂåñ‰øùÂØÜÈÄüÁéá‰∏ãÁïå)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†Á∫¶ÊùüÊù°‰ª∂)

[//]: # (        subject to)

[//]: # (        % ÂØπÊØè‰∏™Ë∑ØÂæÑÁÇπËÆ°ÁÆóÈÄüÁéáÁ∫¶Êùü)

[//]: # (        for k = 1:N)

[//]: # (            % ËÆ°ÁÆóÁõ¥Êé•‰ø°ÈÅìË∑ùÁ¶ªÂíåÂ¢ûÁõä)

[//]: # (            s_d = sqrt&#40;&#40;x0&#40;k&#41;-x_b&#41;^2 + &#40;y0&#40;k&#41;-y_b&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆóÂèçÂ∞Ñ‰ø°ÈÅìË∑ùÁ¶ªÂíåÂ¢ûÁõäÔºàËÄÉËôëRISÈ´òÂ∫¶Ôºâ)

[//]: # (            s_ur = sqrt&#40;&#40;x0&#40;k&#41;-x_r&#41;^2 + &#40;y0&#40;k&#41;-y_r&#41;^2 + &#40;H&#40;k&#41;-H_r&#41;^2&#41;;  % UAVÂà∞RISË∑ùÁ¶ª)

[//]: # (            s_rd = sqrt&#40;&#40;x_r-x_b&#41;^2 + &#40;y_r-y_b&#41;^2 + H_r^2&#41;;             % RISÂà∞Áî®Êà∑Ë∑ùÁ¶ª)

[//]: # (            h_r = beta * sum&#40;exp&#40;1j * theta&#41;&#41; * alpha0 / &#40;s_ur * s_rd&#41;;)

[//]: # (            )
[//]: # (            % ÊÄª‰ø°ÈÅìÂ¢ûÁõäÂíåÊé•Êî∂ÂäüÁéá)

[//]: # (            h_total = h_d + h_r;)

[//]: # (            P_d = p&#40;k&#41; * abs&#40;h_total&#41;^2;)

[//]: # (            )
[//]: # (            % Áî®Êà∑‰ø°ÈÅìÂÆπÈáè)

[//]: # (            RDL = log2&#40;1 + P_d / sigma2&#41;;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆóÁ™ÉÂê¨ËÄÖ‰ø°ÈÅìÂÆπÈáèÔºà‰ªÖÁõ¥Êé•Ë∑ØÂæÑÔºâ)

[//]: # (            s_e = sqrt&#40;&#40;x0&#40;k&#41;-x_e&#41;^2 + &#40;y0&#40;k&#41;-y_e&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            s_e2 = sqrt&#40;&#40;x0&#40;k&#41;-x_e2&#41;^2 + &#40;y0&#40;k&#41;-x_e2&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            s_e3 = sqrt&#40;&#40;x0&#40;k&#41;-x_e3&#41;^2 + &#40;y0&#40;k&#41;-x_e3&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            h_e = alpha0 / &#40;s_e^2&#41;;)

[//]: # (            h_e2 = alpha0 / &#40;s_e2^2&#41;;)

[//]: # (            h_e3 = alpha0 / &#40;s_e3^2&#41;;)

[//]: # (            REL = log2&#40;1 + p_e&#40;k&#41; * h_e / sigma2&#41;;)

[//]: # (            REL2 = log2&#40;1 + p_e&#40;k&#41; * h_e2 / sigma2&#41;;)

[//]: # (            REL3 = log2&#40;1 + p_e&#40;k&#41; * h_e3 / sigma2&#41;;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆó‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÁ≥ªÊï∞ÔºàÁî®Êà∑Ôºâ)

[//]: # (            ADL = &#40;p&#40;k&#41; * abs&#40;h_total&#41;^2&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + P_d&#41; * s_d^2&#41;;)

[//]: # (            BDL = -2 * &#40;x_b - x0&#40;k&#41;&#41; * ADL;)

[//]: # (            CDL = -2 * &#40;y_b - y0&#40;k&#41;&#41; * ADL;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆó‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÁ≥ªÊï∞ÔºàÁ™ÉÂê¨ËÄÖÔºâ)

[//]: # (            AEL = &#40;p_e&#40;k&#41; * h_e&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e&#41; * s_e^2&#41;;)

[//]: # (            AEL2 = &#40;p_e&#40;k&#41; * h_e2&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e2&#41; * s_e2^2&#41;;)

[//]: # (            AEL3 = &#40;p_e&#40;k&#41; * h_e3&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e3&#41; * s_e3^2&#41;;)

[//]: # (            BEL = -2 * &#40;x_e - x0&#40;k&#41;&#41; * AEL;)

[//]: # (            BEL2 = -2 * &#40;x_e2 - x0&#40;k&#41;&#41; * AEL2;)

[//]: # (            BEL3 = -2 * &#40;x_e3 - x0&#40;k&#41;&#41; * AEL3;)

[//]: # (            CEL = -2 * &#40;y_e - y0&#40;k&#41;&#41; * AEL;)

[//]: # (            CEL2 = -2 * &#40;y_e2 - y0&#40;k&#41;&#41; * AEL2;)

[//]: # (            CEL3 = -2 * &#40;y_e3 - y0&#40;k&#41;&#41; * AEL3;)

[//]: # (            )
[//]: # (            % Ê∑ªÂä†ÈÄüÁéáÁ∫¶ÊùüÔºà‰ΩøÁî®‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÔºâ)

[//]: # (            x&#40;2*N+k&#41; <= RDL - ADL * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BDL * x&#40;k&#41; - CDL * x&#40;N+k&#41;;)

[//]: # (            x&#40;3*N+k&#41; <= REL - AEL * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL * x&#40;k&#41; - CEL * x&#40;N+k&#41;;)

[//]: # (            x&#40;4*N+k&#41; <= REL2 - AEL2 * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL2 * x&#40;k&#41; - CEL2 * x&#40;N+k&#41;;)

[//]: # (            x&#40;5*N+k&#41; <= REL3 - AEL3 * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL3 * x&#40;k&#41; - CEL3 * x&#40;N+k&#41;;)

[//]: # (        end   )

[//]: # (        )
[//]: # (        % ÂÆö‰πâËæÖÂä©ÂèòÈáèÔºåÁî®‰∫é‰øùÂØÜÈÄüÁéáËÆ°ÁÆó)

[//]: # (        i = &#40;2*N+1&#41;:&#40;3*N&#41;;)

[//]: # (        j = &#40;3*N+1&#41;:&#40;4*N&#41;;)

[//]: # (        A = x&#40;j&#41; - x&#40;i&#41;;)

[//]: # (        A1 = x&#40;j+N&#41; - x&#40;i&#41;;)

[//]: # (        A2 = x&#40;j+2*N&#41; - x&#40;i&#41;;)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†Ë∑ùÁ¶ªÁõ∏ÂÖ≥Á∫¶Êùü)

[//]: # (        for kk = 1:N)

[//]: # (            dd = &#40;x0&#40;kk&#41;-x_b&#41;^2 + &#40;y0&#40;kk&#41;-y_b&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de1 = &#40;x0&#40;kk&#41;-x_e&#41;^2 + &#40;y0&#40;kk&#41;-y_e&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de2 = &#40;x0&#40;kk&#41;-x_e2&#41;^2 + &#40;y0&#40;kk&#41;-x_e2&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de3 = &#40;x0&#40;kk&#41;-x_e3&#41;^2 + &#40;y0&#40;kk&#41;-y_e3&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            if &#40;dd >= de1&#41;)

[//]: # (                A&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (            if &#40;dd >= de2&#41;)

[//]: # (                A1&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (            if &#40;dd >= de3&#41;)

[//]: # (                A2&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (        end)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†‰øùÂØÜÈÄüÁéáÁ∫¶Êùü)

[//]: # (        sum&#40;A&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        sum&#40;A1&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        sum&#40;A2&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†ÈÄüÂ∫¶Á∫¶Êùü)

[//]: # (        for jj = 1:N-1)

[//]: # (            square&#40;x0&#40;jj+1&#41; + x&#40;jj+1&#41; - x0&#40;jj&#41; - x&#40;jj&#41;&#41; + square&#40;y0&#40;jj+1&#41; + x&#40;N+jj+1&#41; - y0&#40;jj&#41; - x&#40;N+jj&#41;&#41; <= v^2;)

[//]: # (        end)

[//]: # (        square&#40;x0&#40;1&#41; + x&#40;1&#41; - x_o&#41; + square&#40;y0&#40;1&#41; + x&#40;N+1&#41; - y_o&#41; <= v^2;)

[//]: # (        square&#40;x_f - x&#40;N&#41; - x0&#40;N&#41;&#41; + square&#40;y_f - x&#40;N+N&#41; - y0&#40;N&#41;&#41; <= v^2;)

[//]: # (    cvx_end)

[//]: # (    )
[//]: # (    % Êõ¥Êñ∞Êó†‰∫∫Êú∫‰ΩçÁΩÆ)

[//]: # (    x0 = x0 + x&#40;1:N&#41;;      % Êõ¥Êñ∞xÂùêÊ†á)

[//]: # (    y0 = y0 + x&#40;N+1:2*N&#41;;  % Êõ¥Êñ∞yÂùêÊ†á)

[//]: # (    )
[//]: # (    % Âõ∫ÂÆöËΩ®ËøπÔºå‰ºòÂåñRISÁõ∏‰ΩçÔºàÁÆÄÂçïÊúÄÂ§ßÂåñÊñπÊ≥ïÔºâ)

[//]: # (    for k = 1:N)

[//]: # (        s_ur = sqrt&#40;&#40;x0&#40;k&#41;-x_r&#41;^2 + &#40;y0&#40;k&#41;-y_r&#41;^2 + &#40;H&#40;k&#41;-H_r&#41;^2&#41;;)

[//]: # (        s_d = sqrt&#40;&#40;x0&#40;k&#41;-x_b&#41;^2 + &#40;y0&#40;k&#41;-y_b&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (        h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (        % ‰ºòÂåñÁõÆÊ†áÔºöÊúÄÂ§ßÂåñ|h_d + h_r|^2)

[//]: # (        phi_opt = angle&#40;h_d&#41; * ones&#40;M, 1&#41;;  % ÁÆÄÂçïÂÅáËÆæÔºöÁõ∏‰ΩçÂØπÈΩêÁõ¥Êé•Ë∑ØÂæÑ)

[//]: # (        theta = phi_opt;  % Êõ¥Êñ∞Áõ∏‰Ωç)

[//]: # (    end)

[//]: # (    )
[//]: # (    % ËÆ°ÁÆóÂÆûÈôÖ‰øùÂØÜÈÄüÁéá)

[//]: # (    rate = []; rate_u = []; rate_e0 = [];)

[//]: # (    for l = 1:N )

[//]: # (        % Áî®Êà∑‰ø°ÈÅìÔºàÁõ¥Êé•Ë∑ØÂæÑ + ÂèçÂ∞ÑË∑ØÂæÑÔºâ)

[//]: # (        s_d = sqrt&#40;&#40;x0&#40;l&#41;-x_b&#41;^2 + &#40;y0&#40;l&#41;-y_b&#41;^2 + H&#40;l&#41;^2&#41;;)

[//]: # (        h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (        s_ur = sqrt&#40;&#40;x0&#40;l&#41;-x_r&#41;^2 + &#40;y0&#40;l&#41;-y_r&#41;^2 + &#40;H&#40;l&#41;-H_r&#41;^2&#41;;)

[//]: # (        s_rd = sqrt&#40;&#40;x_r-x_b&#41;^2 + &#40;y_r-y_b&#41;^2 + H_r^2&#41;;)

[//]: # (        h_r = beta * sum&#40;exp&#40;1j * theta&#41;&#41; * alpha0 / &#40;s_ur * s_rd&#41;;)

[//]: # (        h_total = h_d + h_r;)

[//]: # (        rate_u = log2&#40;1 + p&#40;l&#41; * abs&#40;h_total&#41;^2 / sigma2&#41;;)

[//]: # (        )
[//]: # (        % Á™ÉÂê¨ËÄÖ‰ø°ÈÅìÔºà‰ªÖÁõ¥Êé•Ë∑ØÂæÑÔºâ)

[//]: # (        rate_e = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e&#41;^2 + &#40;y0&#40;l&#41;-y_e&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e2 = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e2&#41;^2 + &#40;y0&#40;l&#41;-x_e2&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e3 = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e3&#41;^2 + &#40;y0&#40;l&#41;-x_e3&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e0 = max&#40;[rate_e, rate_e2, rate_e3]&#41;;)

[//]: # (        )
[//]: # (        % ËÆ°ÁÆó‰øùÂØÜÈÄüÁéá)

[//]: # (        rate&#40;l&#41; = max&#40;rate_u - rate_e0, 0&#41;;)

[//]: # (    end)

[//]: # (    secrecy_rate&#40;mm&#41; = sum&#40;rate&#41; / N;  % Â≠òÂÇ®ÊØèÊ¨°Ëø≠‰ª£ÁöÑÂπ≥Âùá‰øùÂØÜÈÄüÁéá)

[//]: # (end)

[//]: # ()
[//]: # (% ÂáÜÂ§áÁªòÂõæÊï∞ÊçÆÔºàÊ∑ªÂä†Ëµ∑ÁÇπÂíåÁªàÁÇπÔºâ)

[//]: # (x0 = [0; x0; x_f];)

[//]: # (y0 = [0; y0; y_f];)

[//]: # (z0 = [0; H; 0];  % Ê∑ªÂä†È´òÂ∫¶Áª¥Â∫¶)

[//]: # ()
[//]: # (% ËÆ°ÁÆóÊó†‰∫∫Êú∫ÈÄüÂ∫¶)

[//]: # (for i = 1:size&#40;x0&#41;-1)

[//]: # (    uav_speed&#40;i&#41; = sqrt&#40;&#40;x0&#40;i+1&#41;-x0&#40;i&#41;&#41;^2 + &#40;y0&#40;i+1&#41;-y0&#40;i&#41;&#41;^2&#41;;)

[//]: # (end )

[//]: # ()
[//]: # (% ÁªòÂà∂3DËΩ®ËøπÂõæÔºàËÄÉËôëÈ´òÂ∫¶Ôºâ)

[//]: # (figure;)

[//]: # (plot3&#40;x0, y0, z0, 'b-', 'LineWidth', 1.5&#41;; % Êó†‰∫∫Êú∫Ë∑ØÂæÑ)

[//]: # (hold on;)

[//]: # ()
[//]: # (% ÁªòÂà∂Áî®Êà∑„ÄÅÁ™ÉÂê¨ËÄÖÂíåRIS‰ΩçÁΩÆÔºà3DÔºâ)

[//]: # (plot3&#40;x_b, y_b, 0, 'ro', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_b+5, y_b+5, 0, 'User', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e, y_e, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e+5, y_e+5, 0, 'Eavesdropper 1', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e2, y_e2, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e2+5, y_e2+5, 0, 'Eavesdropper 2', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e3, y_e3, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e3+5, y_e3+5, 0, 'Eavesdropper 3', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_r, y_r, H_r, 'gs', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_r+5, y_r+5, H_r, 'RIS', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (% ÁªòÂà∂Ëµ∑ÁÇπÂíåÁªàÁÇπ)

[//]: # (plot3&#40;x0&#40;1&#41;, y0&#40;1&#41;, z0&#40;1&#41;, 'g^', 'MarkerSize', 12, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x0&#40;1&#41;+5, y0&#40;1&#41;+5, z0&#40;1&#41;, 'Start', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x0&#40;end&#41;, y0&#40;end&#41;, z0&#40;end&#41;, 'ms', 'MarkerSize', 12, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x0&#40;end&#41;+5, y0&#40;end&#41;+5, z0&#40;end&#41;, 'End', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (% ËÆæÁΩÆÂõæÂΩ¢Â±ûÊÄß)

[//]: # (grid on;)

[//]: # (xlabel&#40;'X coordinate'&#41;;)

[//]: # (ylabel&#40;'Y coordinate'&#41;;)

[//]: # (zlabel&#40;'Z coordinate'&#41;;)

[//]: # (title&#40;'UAV Trajectory with RIS, User, and Eavesdroppers &#40;3D&#41;'&#41;;)

[//]: # (legend&#40;'UAV Path', 'User', 'Eavesdropper 1', 'Eavesdropper 2', 'Eavesdropper 3', 'RIS', 'Start', 'End'&#41;;)

[//]: # (view&#40;-37.5, 30&#41;; % ËÆæÁΩÆËßÜËßí)

[//]: # (hold off;)

[//]: # ()
[//]: # (% ÁªòÂà∂‰øùÂØÜÈÄüÁéáÈöèËø≠‰ª£Ê¨°Êï∞ÂèòÂåñÂõæ)

[//]: # (figure;)

[//]: # (plot&#40;1:5, secrecy_rate, 'b-o', 'LineWidth', 1.5, 'MarkerSize', 8&#41;;)

[//]: # (grid on;)

[//]: # (xlabel&#40;'Iteration Number'&#41;;)

[//]: # (ylabel&#40;'Secrecy Rate &#40;bits/s&#41;'&#41;;)

[//]: # (title&#40;'Secrecy Rate vs. Iteration Number with RIS'&#41;;)

[//]: # (legend&#40;'Secrecy Rate'&#41;;)

[//]: # ()
[//]: # (% ÊòæÁ§∫ÊØèÊ¨°Ëø≠‰ª£ÁöÑ‰øùÂØÜÈÄüÁéá)

[//]: # (disp&#40;'Secrecy Rate for each iteration with RIS:'&#41;;)

[//]: # (disp&#40;secrecy_rate&#41;;)

[//]: # (```)

[//]: # ()
[//]: # ()
[//]: # (```ris)

[//]: # (% Ê∏ÖÁ©∫Â∑•‰ΩúÂå∫ÂèòÈáèÔºåÂÖ≥Èó≠ÊâÄÊúâÂõæÂΩ¢Á™óÂè£)

[//]: # (clc)

[//]: # (clear all)

[//]: # (close all)

[//]: # ()
[//]: # (% ÂàùÂßãÂåñÂèÇÊï∞)

[//]: # (N = 100;                    % Ë∑ØÂæÑÁÇπÊï∞Èáè)

[//]: # (x0 = linspace&#40;0, 400, N&#41;';  % ÂàùÂßãxÂùêÊ†áÔºå‰ªé0Âà∞400Á∫øÊÄßÂàÜÂ∏É)

[//]: # (y0 = zeros&#40;N, 1&#41;;           % ÂàùÂßãyÂùêÊ†áÔºåÂÖ®ÈÉ®‰∏∫0)

[//]: # (H = 100 * ones&#40;N, 1&#41;;       % Êó†‰∫∫Êú∫È£ûË°åÈ´òÂ∫¶ÔºåÂõ∫ÂÆö‰∏∫100Á±≥)

[//]: # (x_o = 0; y_o = 0;           % Ëµ∑ÁÇπÂùêÊ†á &#40;0,0&#41;)

[//]: # (x_f = 400; y_f = 0;         % ÁªàÁÇπÂùêÊ†á &#40;400,0&#41;)

[//]: # (x_b = 200; y_b = 200;       % Áî®Êà∑‰ΩçÁΩÆÂùêÊ†á &#40;200,200&#41;)

[//]: # (x_e = 50; y_e = 250;        % Á™ÉÂê¨ËÄÖ1‰ΩçÁΩÆÂùêÊ†á &#40;50,250&#41;)

[//]: # (x_e2 = 300; y_e2 = 50;      % Á™ÉÂê¨ËÄÖ2‰ΩçÁΩÆÂùêÊ†á &#40;300,50&#41;)

[//]: # (x_e3 = 50; y_e3 = 100;      % Á™ÉÂê¨ËÄÖ3‰ΩçÁΩÆÂùêÊ†á &#40;50,100&#41;)

[//]: # (v = 20;                     % Êó†‰∫∫Êú∫ÊúÄÂ§ßÈÄüÂ∫¶ÈôêÂà∂ &#40;Á±≥/Áßí&#41;)

[//]: # (x_r = 200; y_r = 100; H_r = 30;  % RIS‰ΩçÁΩÆÂùêÊ†á &#40;200,100,30&#41;)

[//]: # (beta = 0.75;                % RISÊØè‰∏™ÂçïÂÖÉÁöÑÂèçÂ∞ÑÂ¢ûÁõä)

[//]: # (M = 64;                     % RISÂèçÂ∞ÑÂçïÂÖÉÊï∞ÔºåÂõ∫ÂÆö‰∏∫64)

[//]: # ()
[//]: # (% Áî®‰∫éÂ≠òÂÇ®ÊØèÊ¨°Ëø≠‰ª£ÁöÑ‰øùÂØÜÈÄüÁéá)

[//]: # (secrecy_rate_ris = zeros&#40;1, 5&#41;;)

[//]: # ()
[//]: # (% ÂàùÂßãÂåñRISÁõ∏‰Ωç)

[//]: # (theta = 2 * pi * rand&#40;M, 1&#41;;  % ÂàùÂßãÁõ∏‰ΩçÔºåËåÉÂõ¥[0, 2pi&#41;)

[//]: # ()
[//]: # (% ‰∏ª‰ºòÂåñÂæ™ÁéØÔºåÊâßË°å5Ê¨°Ëø≠‰ª£)

[//]: # (for mm = 1:5)

[//]: # (    % ÂàùÂßãÂåñÂäüÁéáÂèÇÊï∞)

[//]: # (    p = 0.1 * ones&#40;N, 1&#41;;      % ‰º†ËæìÂäüÁéá20dBm &#40;0.1 W&#41;)

[//]: # (    p_e = 0.1 * ones&#40;N, 1&#41;;    % Á™ÉÂê¨ËÄÖÂäüÁéáÔºàËøôÈáåÂÅáËÆæ‰∏éÁî®Êà∑Áõ∏ÂêåÔºâ)

[//]: # (    alpha0 = 10^&#40;-5&#41;;          % ÂèÇËÄÉË∑ùÁ¶ª1Á±≥Êó∂ÁöÑ‰ø°ÈÅìÂäüÁéáÂ¢ûÁõä)

[//]: # (    sigma2 = 10^&#40;-11.4&#41;;       % È´òÊñØÁôΩÂô™Â£∞ÂäüÁéá)

[//]: # (    )
[//]: # (    % CVX‰ºòÂåñÈÉ®ÂàÜ - ‰ΩøÁî®Âá∏‰ºòÂåñÊ±ÇËß£Êó†‰∫∫Êú∫ËΩ®Ëøπ)

[//]: # (    n = 6 * N + 1;             % ÂèòÈáèÊÄªÊï∞)

[//]: # (    cvx_begin       )

[//]: # (        variable x&#40;n&#41; nonnegative  % ÂÆö‰πâÈùûË¥ü‰ºòÂåñÂèòÈáè)

[//]: # (        maximize&#40;x&#40;6*N+1&#41;&#41;        % ÁõÆÊ†áÔºöÊúÄÂ§ßÂåñ‰øùÂØÜÈÄüÁéá‰∏ãÁïå)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†Á∫¶ÊùüÊù°‰ª∂)

[//]: # (        subject to)

[//]: # (        for k = 1:N)

[//]: # (            % ËÆ°ÁÆóÁõ¥Êé•‰ø°ÈÅìË∑ùÁ¶ªÂíåÂ¢ûÁõä)

[//]: # (            s_d = sqrt&#40;&#40;x0&#40;k&#41;-x_b&#41;^2 + &#40;y0&#40;k&#41;-y_b&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆóÂèçÂ∞Ñ‰ø°ÈÅìË∑ùÁ¶ªÂíåÂ¢ûÁõäÔºàËÄÉËôëRISÈ´òÂ∫¶Ôºâ)

[//]: # (            s_ur = sqrt&#40;&#40;x0&#40;k&#41;-x_r&#41;^2 + &#40;y0&#40;k&#41;-y_r&#41;^2 + &#40;H&#40;k&#41;-H_r&#41;^2&#41;;  % UAVÂà∞RISË∑ùÁ¶ª)

[//]: # (            s_rd = sqrt&#40;&#40;x_r-x_b&#41;^2 + &#40;y_r-y_b&#41;^2 + H_r^2&#41;;             % RISÂà∞Áî®Êà∑Ë∑ùÁ¶ª)

[//]: # (            h_r = beta * sum&#40;exp&#40;1j * theta&#41;&#41; * alpha0 / &#40;s_ur * s_rd&#41;;)

[//]: # (            )
[//]: # (            % ÊÄª‰ø°ÈÅìÂ¢ûÁõäÂíåÊé•Êî∂ÂäüÁéá)

[//]: # (            h_total = h_d + h_r;)

[//]: # (            P_d = p&#40;k&#41; * abs&#40;h_total&#41;^2;)

[//]: # (            )
[//]: # (            % Áî®Êà∑‰ø°ÈÅìÂÆπÈáè)

[//]: # (            RDL = log2&#40;1 + P_d / sigma2&#41;;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆóÁ™ÉÂê¨ËÄÖ‰ø°ÈÅìÂÆπÈáèÔºà‰ªÖÁõ¥Êé•Ë∑ØÂæÑÔºâ)

[//]: # (            s_e = sqrt&#40;&#40;x0&#40;k&#41;-x_e&#41;^2 + &#40;y0&#40;k&#41;-y_e&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            s_e2 = sqrt&#40;&#40;x0&#40;k&#41;-x_e2&#41;^2 + &#40;y0&#40;k&#41;-x_e2&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            s_e3 = sqrt&#40;&#40;x0&#40;k&#41;-x_e3&#41;^2 + &#40;y0&#40;k&#41;-x_e3&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (            h_e = alpha0 / &#40;s_e^2&#41;;)

[//]: # (            h_e2 = alpha0 / &#40;s_e2^2&#41;;)

[//]: # (            h_e3 = alpha0 / &#40;s_e3^2&#41;;)

[//]: # (            REL = log2&#40;1 + p_e&#40;k&#41; * h_e / sigma2&#41;;)

[//]: # (            REL2 = log2&#40;1 + p_e&#40;k&#41; * h_e2 / sigma2&#41;;)

[//]: # (            REL3 = log2&#40;1 + p_e&#40;k&#41; * h_e3 / sigma2&#41;;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆó‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÁ≥ªÊï∞ÔºàÁî®Êà∑Ôºâ)

[//]: # (            ADL = &#40;p&#40;k&#41; * abs&#40;h_total&#41;^2&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + P_d&#41; * s_d^2&#41;;)

[//]: # (            BDL = -2 * &#40;x_b - x0&#40;k&#41;&#41; * ADL;)

[//]: # (            CDL = -2 * &#40;y_b - y0&#40;k&#41;&#41; * ADL;)

[//]: # (            )
[//]: # (            % ËÆ°ÁÆó‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÁ≥ªÊï∞ÔºàÁ™ÉÂê¨ËÄÖÔºâ)

[//]: # (            AEL = &#40;p_e&#40;k&#41; * h_e&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e&#41; * s_e^2&#41;;)

[//]: # (            AEL2 = &#40;p_e&#40;k&#41; * h_e2&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e2&#41; * s_e2^2&#41;;)

[//]: # (            AEL3 = &#40;p_e&#40;k&#41; * h_e3&#41; / &#40;log&#40;2&#41; * &#40;sigma2 + p_e&#40;k&#41; * h_e3&#41; * s_e3^2&#41;;)

[//]: # (            BEL = -2 * &#40;x_e - x0&#40;k&#41;&#41; * AEL;)

[//]: # (            BEL2 = -2 * &#40;x_e2 - x0&#40;k&#41;&#41; * AEL2;)

[//]: # (            BEL3 = -2 * &#40;x_e3 - x0&#40;k&#41;&#41; * AEL3;)

[//]: # (            CEL = -2 * &#40;y_e - y0&#40;k&#41;&#41; * AEL;)

[//]: # (            CEL2 = -2 * &#40;y_e2 - y0&#40;k&#41;&#41; * AEL2;)

[//]: # (            CEL3 = -2 * &#40;y_e3 - y0&#40;k&#41;&#41; * AEL3;)

[//]: # (            )
[//]: # (            % Ê∑ªÂä†ÈÄüÁéáÁ∫¶ÊùüÔºà‰ΩøÁî®‰∏ÄÈò∂Ê≥∞ÂãíËøë‰ººÔºâ)

[//]: # (            x&#40;2*N+k&#41; <= RDL - ADL * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BDL * x&#40;k&#41; - CDL * x&#40;N+k&#41;;)

[//]: # (            x&#40;3*N+k&#41; <= REL - AEL * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL * x&#40;k&#41; - CEL * x&#40;N+k&#41;;)

[//]: # (            x&#40;4*N+k&#41; <= REL2 - AEL2 * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL2 * x&#40;k&#41; - CEL2 * x&#40;N+k&#41;;)

[//]: # (            x&#40;5*N+k&#41; <= REL3 - AEL3 * &#40;square&#40;x&#40;k&#41;&#41; + square&#40;x&#40;N+k&#41;&#41;&#41; - BEL3 * x&#40;k&#41; - CEL3 * x&#40;N+k&#41;;)

[//]: # (        end   )

[//]: # (        )
[//]: # (        % ÂÆö‰πâËæÖÂä©ÂèòÈáèÔºåÁî®‰∫é‰øùÂØÜÈÄüÁéáËÆ°ÁÆó)

[//]: # (        i = &#40;2*N+1&#41;:&#40;3*N&#41;;)

[//]: # (        j = &#40;3*N+1&#41;:&#40;4*N&#41;;)

[//]: # (        A = x&#40;j&#41; - x&#40;i&#41;;)

[//]: # (        A1 = x&#40;j+N&#41; - x&#40;i&#41;;)

[//]: # (        A2 = x&#40;j+2*N&#41; - x&#40;i&#41;;)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†Ë∑ùÁ¶ªÁõ∏ÂÖ≥Á∫¶Êùü)

[//]: # (        for kk = 1:N)

[//]: # (            dd = &#40;x0&#40;kk&#41;-x_b&#41;^2 + &#40;y0&#40;kk&#41;-y_b&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de1 = &#40;x0&#40;kk&#41;-x_e&#41;^2 + &#40;y0&#40;kk&#41;-y_e&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de2 = &#40;x0&#40;kk&#41;-x_e2&#41;^2 + &#40;y0&#40;kk&#41;-x_e2&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            de3 = &#40;x0&#40;kk&#41;-x_e3&#41;^2 + &#40;y0&#40;kk&#41;-x_e3&#41;^2 + H&#40;kk&#41;^2;)

[//]: # (            if &#40;dd >= de1&#41;)

[//]: # (                A&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (            if &#40;dd >= de2&#41;)

[//]: # (                A1&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (            if &#40;dd >= de3&#41;)

[//]: # (                A2&#40;kk&#41; = 0;)

[//]: # (            end)

[//]: # (        end)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†‰øùÂØÜÈÄüÁéáÁ∫¶Êùü)

[//]: # (        sum&#40;A&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        sum&#40;A1&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        sum&#40;A2&#41; <= -x&#40;6*N+1&#41;;)

[//]: # (        )
[//]: # (        % Ê∑ªÂä†ÈÄüÂ∫¶Á∫¶Êùü)

[//]: # (        for jj = 1:N-1)

[//]: # (            square&#40;x0&#40;jj+1&#41; + x&#40;jj+1&#41; - x0&#40;jj&#41; - x&#40;jj&#41;&#41; + square&#40;y0&#40;jj+1&#41; + x&#40;N+jj+1&#41; - y0&#40;jj&#41; - x&#40;N+jj&#41;&#41; <= v^2;)

[//]: # (        end)

[//]: # (        square&#40;x0&#40;1&#41; + x&#40;1&#41; - x_o&#41; + square&#40;y0&#40;1&#41; + x&#40;N+1&#41; - y_o&#41; <= v^2;)

[//]: # (        square&#40;x_f - x&#40;N&#41; - x0&#40;N&#41;&#41; + square&#40;y_f - x&#40;N+N&#41; - y0&#40;N&#41;&#41; <= v^2;)

[//]: # (    cvx_end)

[//]: # (    )
[//]: # (    % Êõ¥Êñ∞Êó†‰∫∫Êú∫‰ΩçÁΩÆ)

[//]: # (    x0 = x0 + x&#40;1:N&#41;;      % Êõ¥Êñ∞xÂùêÊ†á)

[//]: # (    y0 = y0 + x&#40;N+1:2*N&#41;;  % Êõ¥Êñ∞yÂùêÊ†á)

[//]: # (    )
[//]: # (    % Âõ∫ÂÆöËΩ®ËøπÔºå‰ºòÂåñRISÁõ∏‰ΩçÔºàÁÆÄÂçïÊúÄÂ§ßÂåñÊñπÊ≥ïÔºâ)

[//]: # (    for k = 1:N)

[//]: # (        s_ur = sqrt&#40;&#40;x0&#40;k&#41;-x_r&#41;^2 + &#40;y0&#40;k&#41;-y_r&#41;^2 + &#40;H&#40;k&#41;-H_r&#41;^2&#41;;)

[//]: # (        s_d = sqrt&#40;&#40;x0&#40;k&#41;-x_b&#41;^2 + &#40;y0&#40;k&#41;-y_b&#41;^2 + H&#40;k&#41;^2&#41;;)

[//]: # (        h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (        phi_opt = angle&#40;h_d&#41; * ones&#40;M, 1&#41;;  % ÁÆÄÂçïÂÅáËÆæÔºöÁõ∏‰ΩçÂØπÈΩêÁõ¥Êé•Ë∑ØÂæÑ)

[//]: # (        theta = phi_opt;  % Êõ¥Êñ∞Áõ∏‰Ωç)

[//]: # (    end)

[//]: # (    )
[//]: # (    % ËÆ°ÁÆóÂÆûÈôÖ‰øùÂØÜÈÄüÁéá)

[//]: # (    rate = zeros&#40;1, N&#41;;)

[//]: # (    for l = 1:N )

[//]: # (        % Áî®Êà∑‰ø°ÈÅìÔºàÁõ¥Êé•Ë∑ØÂæÑ + ÂèçÂ∞ÑË∑ØÂæÑÔºâ)

[//]: # (        s_d = sqrt&#40;&#40;x0&#40;l&#41;-x_b&#41;^2 + &#40;y0&#40;l&#41;-y_b&#41;^2 + H&#40;l&#41;^2&#41;;)

[//]: # (        h_d = sqrt&#40;alpha0&#41; / s_d;)

[//]: # (        s_ur = sqrt&#40;&#40;x0&#40;l&#41;-x_r&#41;^2 + &#40;y0&#40;l&#41;-y_r&#41;^2 + &#40;H&#40;l&#41;-H_r&#41;^2&#41;;)

[//]: # (        s_rd = sqrt&#40;&#40;x_r-x_b&#41;^2 + &#40;y_r-y_b&#41;^2 + H_r^2&#41;;)

[//]: # (        h_r = beta * sum&#40;exp&#40;1j * theta&#41;&#41; * alpha0 / &#40;s_ur * s_rd&#41;;)

[//]: # (        h_total = h_d + h_r;)

[//]: # (        rate_u = log2&#40;1 + p&#40;l&#41; * abs&#40;h_total&#41;^2 / sigma2&#41;;)

[//]: # (        )
[//]: # (        % Á™ÉÂê¨ËÄÖ‰ø°ÈÅìÔºà‰ªÖÁõ¥Êé•Ë∑ØÂæÑÔºâ)

[//]: # (        rate_e = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e&#41;^2 + &#40;y0&#40;l&#41;-y_e&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e2 = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e2&#41;^2 + &#40;y0&#40;l&#41;-x_e2&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e3 = log2&#40;1 + p_e&#40;l&#41; * alpha0 / &#40;sqrt&#40;&#40;x0&#40;l&#41;-x_e3&#41;^2 + &#40;y0&#40;l&#41;-x_e3&#41;^2 + H&#40;l&#41;^2&#41;^2&#41; / sigma2&#41;;)

[//]: # (        rate_e0 = max&#40;[rate_e, rate_e2, rate_e3]&#41;;)

[//]: # (        )
[//]: # (        % ËÆ°ÁÆó‰øùÂØÜÈÄüÁéá)

[//]: # (        rate&#40;l&#41; = max&#40;rate_u - rate_e0, 0&#41;;)

[//]: # (    end)

[//]: # (    secrecy_rate_ris&#40;mm&#41; = sum&#40;rate&#41; / N;  % Â≠òÂÇ®ÊØèÊ¨°Ëø≠‰ª£ÁöÑÂπ≥Âùá‰øùÂØÜÈÄüÁéá)

[//]: # (end)

[//]: # ()
[//]: # (% ÂáÜÂ§áÁªòÂõæÊï∞ÊçÆÔºàÊ∑ªÂä†Ëµ∑ÁÇπÂíåÁªàÁÇπÔºâ)

[//]: # (x0 = [0; x0; x_f];)

[//]: # (y0 = [0; y0; y_f];)

[//]: # (z0 = [0; H; 0];  % Ê∑ªÂä†È´òÂ∫¶Áª¥Â∫¶)

[//]: # ()
[//]: # (% ËÆ°ÁÆóÊó†‰∫∫Êú∫ÈÄüÂ∫¶)

[//]: # (uav_speed = zeros&#40;1, length&#40;x0&#41;-1&#41;;)

[//]: # (for i = 1:length&#40;x0&#41;-1)

[//]: # (    uav_speed&#40;i&#41; = sqrt&#40;&#40;x0&#40;i+1&#41;-x0&#40;i&#41;&#41;^2 + &#40;y0&#40;i+1&#41;-y0&#40;i&#41;&#41;^2&#41;;)

[//]: # (end )

[//]: # ()
[//]: # (% ÁªòÂà∂3DËΩ®ËøπÂõæÔºàËÄÉËôëÈ´òÂ∫¶Ôºâ)

[//]: # (figure;)

[//]: # (plot3&#40;x0, y0, z0, 'b-', 'LineWidth', 1.5&#41;; % Êó†‰∫∫Êú∫Ë∑ØÂæÑ)

[//]: # (hold on;)

[//]: # ()
[//]: # (% ÁªòÂà∂Áî®Êà∑„ÄÅÁ™ÉÂê¨ËÄÖÂíåRIS‰ΩçÁΩÆÔºà3DÔºâ)

[//]: # (plot3&#40;x_b, y_b, 0, 'ro', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_b+5, y_b+5, 0, 'User', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e, y_e, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e+5, y_e+5, 0, 'Eavesdropper 1', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e2, y_e2, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e2+5, y_e2+5, 0, 'Eavesdropper 2', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_e3, y_e3, 0, 'kx', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_e3+5, y_e3+5, 0, 'Eavesdropper 3', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x_r, y_r, H_r, 'gs', 'MarkerSize', 10, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x_r+5, y_r+5, H_r, 'RIS', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (% ÁªòÂà∂Ëµ∑ÁÇπÂíåÁªàÁÇπ)

[//]: # (plot3&#40;x0&#40;1&#41;, y0&#40;1&#41;, z0&#40;1&#41;, 'g^', 'MarkerSize', 12, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x0&#40;1&#41;+5, y0&#40;1&#41;+5, z0&#40;1&#41;, 'Start', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (plot3&#40;x0&#40;end&#41;, y0&#40;end&#41;, z0&#40;end&#41;, 'ms', 'MarkerSize', 12, 'LineWidth', 2&#41;;)

[//]: # (text&#40;x0&#40;end&#41;+5, y0&#40;end&#41;+5, z0&#40;end&#41;, 'End', 'FontSize', 12&#41;;)

[//]: # ()
[//]: # (% ËÆæÁΩÆÂõæÂΩ¢Â±ûÊÄß)

[//]: # (grid on;)

[//]: # (xlabel&#40;'X coordinate &#40;m&#41;'&#41;;)

[//]: # (ylabel&#40;'Y coordinate &#40;m&#41;'&#41;;)

[//]: # (zlabel&#40;'Z coordinate &#40;m&#41;'&#41;;)

[//]: # (title&#40;'UAV Trajectory with RIS &#40;M=64&#41;, User, and Eavesdroppers &#40;3D&#41;'&#41;;)

[//]: # (legend&#40;'UAV Path', 'User', 'Eavesdropper 1', 'Eavesdropper 2', 'Eavesdropper 3', 'RIS', 'Start', 'End'&#41;;)

[//]: # (view&#40;-37.5, 30&#41;; % ËÆæÁΩÆËßÜËßí)

[//]: # (hold off;)

[//]: # ()
[//]: # (% ÁªòÂà∂M=64Êó∂ÁöÑ‰øùÂØÜÈÄüÁéáÈöèËø≠‰ª£Ê¨°Êï∞ÂèòÂåñÂõæ)

[//]: # (figure;)

[//]: # (plot&#40;1:5, secrecy_rate_ris, 'b-o', 'LineWidth', 1.5, 'MarkerSize', 8&#41;;)

[//]: # (grid on;)

[//]: # (xlabel&#40;'Iteration Number'&#41;;)

[//]: # (ylabel&#40;'Average Secrecy Rate &#40;bits/s&#41;'&#41;;)

[//]: # (title&#40;'Average Secrecy Rate vs. Iteration Number with RIS &#40;M=64&#41;'&#41;;)

[//]: # (legend&#40;'M = 64'&#41;;)

[//]: # ()
[//]: # (% ÊòæÁ§∫ÊØèÊ¨°Ëø≠‰ª£ÁöÑÂπ≥Âùá‰øùÂØÜÈÄüÁéá)

[//]: # (disp&#40;'Average Secrecy Rate for each iteration with RIS &#40;M=64&#41;:'&#41;;)

[//]: # (disp&#40;secrecy_rate_ris&#41;;)

[//]: # ()
[//]: # (%% Â∞Ü‰øùÂØÜÈÄüÁéáÊï∞ÊçÆ‰øùÂ≠ò‰∏∫CSVÊñá‰ª∂)

[//]: # (filename = 'E:\MATLAB\RIS-UAV-Security\test\test\secrecy_rate_ris.csv';  % ÂÆö‰πâÊñá‰ª∂Âêç)

[//]: # (writematrix&#40;secrecy_rate_ris', filename&#41;;  % ‰øùÂ≠òÊï∞ÊçÆÔºàËΩ¨ÁΩÆ‰∏∫ÂàóÂêëÈáèÔºâ)

[//]: # ()
[//]: # (disp&#40;['‰øùÂØÜÈÄüÁéáÊï∞ÊçÆÂ∑≤‰øùÂ≠ò‰∏∫: ' filename]&#41;;)

[//]: # ()
[//]: # ()
[//]: # ()
[//]: # ()
[//]: # ()
[//]: # (%% ÂáÜÂ§áÂÆåÊï¥ËΩ®ËøπÊï∞ÊçÆÔºàÂåÖÂê´Ëµ∑ÁÇπ„ÄÅ‰∏≠Èó¥ÁÇπÂíåÁªàÁÇπÔºâ)

[//]: # (final_trajectory = [x0, y0, [0; H; 0]];  % ÂåÖÂê´x,y,zÂùêÊ†á)

[//]: # ()
[//]: # (% ‰øùÂ≠ò‰∏∫CSVÊñá‰ª∂)

[//]: # (filename_traj = 'E:\MATLAB\RIS-UAV-Security\test\test\uav_trajectory.csv';)

[//]: # ()
[//]: # (% Ê∑ªÂä†ÂàóÊ†áÈ¢ò)

[//]: # (headers = {'X_coordinate&#40;m&#41;', 'Y_coordinate&#40;m&#41;', 'Z_coordinate&#40;m&#41;'};)

[//]: # (fid = fopen&#40;filename_traj, 'w'&#41;;)

[//]: # (fprintf&#40;fid, '%s,%s,%s\n', headers{:}&#41;;)

[//]: # (fclose&#40;fid&#41;;)

[//]: # ()
[//]: # (% ÂÜôÂÖ•Êï∞ÊçÆ)

[//]: # (writematrix&#40;final_trajectory, filename_traj, 'WriteMode', 'append'&#41;;)

[//]: # ()
[//]: # (disp&#40;['Êó†‰∫∫Êú∫ËΩ®ËøπÊï∞ÊçÆÂ∑≤‰øùÂ≠ò‰∏∫: ' filename_traj]&#41;;)

[//]: # (```)